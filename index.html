<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>竖屏像素绘本</title>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/blasten/turn.js/turn.min.js"></script>
<style>
body {
  margin:0;
  background:#fefefe;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  overflow:hidden;
  font-family:sans-serif;
}

/* 电子书容器 */
#book {
  width:90vw;
  max-width:500px;
  aspect-ratio:9/16;
  box-shadow:0 0 20px rgba(0,0,0,0.3);
  background:#fff;
}
#book .page img {
  width:100%;
  height:100%;
  object-fit:contain;
  display:block;
}

/* 翻页按钮 */
button {
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  background:rgba(0,0,0,0.5);
  color:white;
  border:none;
  padding:12px 24px;
  font-size:20px;
  cursor:pointer;
  border-radius:6px;
  z-index:10;
  user-select:none;
}
#prev { left:20px; }
#next { right:20px; }

/* 音乐按钮固定右上角，不遮挡图片 */
#audio-control {
  position: fixed;
  top:10px;
  right:10px;
  background:rgba(0,0,0,0.5);
  color:white;
  padding:8px 16px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  z-index:20;
}
</style>
</head>
<body>

<!-- 音乐 -->
<audio id="bgm" src="music.mp3" loop></audio>
<button id="audio-control">播放音乐</button>

<!-- 翻页按钮 -->
<button id="prev">⬅ 上一页</button>
<button id="next">下一页 ➡</button>

<!-- 电子书容器 -->
<div id="book">
  <div class="page"><img src="第一个.jpg"></div>
  <div class="page"><img src="第二个.jpg"></div>
  <div class="page"><img src="第三个.jpg"></div>
  <div class="page"><img src="第四个.jpg"></div>
  <div class="page"><img src="第五个.jpg"></div>
  <div class="page"><img src="第六个.jpg"></div>
  <div class="page"><img src="第七个.jpg"></div>
  <div class="page"><img src="第八个.jpg"></div>
  <div class="page"><img src="第九个.jpg"></div>
  <div class="page"><img src="第十个.jpg"></div>
  <div class="page"><img src="第十一个.jpg"></div>
  <div class="page"><img src="第十二个.jpg"></div>
  <div class="page"><img src="第十三个.jpg"></div>
  <div class="page"><img src="第十四个.jpg"></div>
  <div class="page"><img src="第十五个.jpg"></div>
  <div class="page"><img src="第十六个.jpg"></div>
  <div class="page"><img src="第十七个.jpg"></div>
  <div class="page"><img src="第十八个.jpg"></div>
  <div class="page"><img src="第十九个.jpg"></div>
  <div class="page"><img src="第二十个.jpg"></div>
</div>

<script>
$(function(){
  const $book = $("#book");
  const bgm = document.getElementById('bgm');

  // 等待所有图片加载完成
  const images = $book.find("img");
  let loaded = 0;

  images.each(function(){
    $(this).on('load', function(){
      loaded++;
      if(loaded === images.length){
        initBook(); // 所有图片加载完再初始化 Turn.js
      }
    }).each(function(){ if(this.complete) $(this).trigger('load'); });
  });

  function initBook(){
    const bookWidth = $book.width();
    const bookHeight = Math.round(bookWidth * 16 / 9); // 竖屏 9:16

    $book.turn({
      width: bookWidth,
      height: bookHeight,
      autoCenter: true,
      duration: 600,
      display: "single"  // 单页模式
    });

    // 翻页按钮
    $("#next").off('click').on('click', ()=> $book.turn("next"));
    $("#prev").off('click').on('click', ()=> $book.turn("previous"));

    // 键盘翻页
    $(document).off('keydown').on('keydown', function(e){
      if(e.key === "ArrowRight") $book.turn("next");
      if(e.key === "ArrowLeft") $book.turn("previous");
    });

    // 音乐控制
    $("#audio-control").off('click').on('click', function(){
      if(bgm.paused){
        bgm.play().catch(err => console.log(err)); // 防止浏览器阻止自动播放报错
        $(this).text("暂停音乐");
      } else {
        bgm.pause();
        $(this).text("播放音乐");
      }
    });

    // 窗口缩放时更新 Turn.js 尺寸
    $(window).on('resize', function(){
      const newWidth = $book.width();
      const newHeight = Math.round(newWidth * 16 / 9);
      $book.turn("size", newWidth, newHeight);
    });
  }
});
</script>

</body>
</html>
